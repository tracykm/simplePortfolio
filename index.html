<html>
  <style>
    body {
      font-size: 18px;
      font-family: "Gill Sans", "Gill Sans MT", Calibri, "Trebuchet MS",
        sans-serif;
      max-width: 1200px;
      padding: 1rem;
      margin: auto;
    }
    main {
      margin-top: -2rem;
    }
    header a {
      color: black;
      text-decoration: none;
    }
    h1 {
      font-weight: 100;
      font-size: 72px;
    }
    .thumb-gallery {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      /* grid-auto-rows: minmax(300px, auto); */
      grid-auto-rows: 300px;
      margin: auto;
    }
    header {
      position: sticky;
      top: 0;
      background: white;
    }
    footer {
      position: sticky;
      bottom: 0;
      background: white;
      padding: 1rem 0;
      display: flex;
    }
    .contact {
      flex-grow: 1;
      text-align: center;
    }
    .full-images img {
      width: 100%;
    }
    .thumb {
      /* width: 100%; */
      overflow: hidden;
    }
  </style>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>
    function renderGroupImages({ grouped, group }) {
      window.group = group;
      $(".thumb-gallery").html("");
      $(".full-images").html(
        grouped[group]
          .map(imgStr => {
            return `<img class="full-img" id="${imgStr}" src="https://res.cloudinary.com/spiffysparrow/image/upload//w_1200/${imgStr}" />`;
          })
          .join("")
      );
    }

    function renderThumbs(grouped) {
      $(".full-images").html("");
      Object.keys(grouped).forEach(groupName => {
        const group = grouped[groupName];
        $(".thumb-gallery").prepend(`
          <div class="thumb">
            <a href="#ex1" rel="modal:open">
                <img class="thumb-img" data-group="${groupName}" id="${
          group[0]
        }" src="https://res.cloudinary.com/spiffysparrow/image/upload//w_500/${
          group[0]
        }" />
            </a>
          </div>
        `);
      });
    }

    $.ajax(
      "https://res.cloudinary.com/spiffysparrow/image/list/cardboard.json"
    ).then(({ resources }) => {
      const grouped = resources.reduce((acc, d) => {
        var arr = d.public_id.split("/");
        acc[arr[1]] = acc[arr[1]] || [];
        acc[arr[1]].push(d.public_id + "." + d.format);
        return acc;
      }, {});

      const groupKeys = Object.keys(grouped);

      renderThumbs(grouped);

      $("body").on("click", ".thumb-img", e => {
        var group = e.currentTarget.dataset.group;
        renderGroupImages({ grouped, group });
      });

      $(".home-btn").click(() => {
        renderThumbs(grouped);
      });
      $(".prev-btn").click(() => {
        var i = groupKeys.indexOf(window.group);
        i--;
        if (i < 0) {
          i = groupKeys.length - 1;
        }
        var newGroup = groupKeys[i];

        renderGroupImages({ grouped, group: newGroup });
      });
      $(".next-btn").click(() => {
        var i = groupKeys.indexOf(window.group);
        i++;
        if (i > groupKeys.length - 1) {
          i = 0;
        }
        var newGroup = groupKeys[i];

        renderGroupImages({ grouped, group: newGroup });
      });
    });
  </script>

  <body>
    <header>
      <a href="#"><h1 class="home-btn">Kakii Keenan</h1></a>
    </header>
    <main>
      <div class="thumb-gallery"></div>
      <div class="full-images"></div>
    </main>
    <footer>
      <a href="#" class="prev-btn">Prev</a>
      <div class="contact">contact - kakiikeenan@gmail.com</div>
      <a href="#" class="next-btn">Next</a>
    </footer>
  </body>
</html>
